<!doctype html>
<html lang="ru" xmlns:th="http://www.w3.org/1999/xhtml">
<head th:replace="~{fragments/layout :: head('Панель пользователя')}"></head>
<body>
<header th:replace="~{fragments/layout :: header}"></header>
<section class="mt-5">
    <div class="container">
        <h2>Панель пользователя <span th:text="${user.username}">user</span></h2>
        <h4 class="mt-4">Изменить пароль</h4>
        <form th:action="@{/user/password}" method="post" class="mb-4">
            <div class="mb-3">
                <label for="currentPassword" class="form-label">Старый пароль</label>
                <input type="password" class="form-control" id="currentPassword" name="currentPassword" autocomplete="new-password">
            </div>
            <div class="mb-3">
                <label for="password" class="form-label">Новый пароль</label>
                <input type="password" class="form-control" id="password" name="password" autocomplete="new-password">
            </div>
            <div class="mb-3">
                <label for="confirmPassword" class="form-label">Подтвердите пароль</label>
                <input type="password" class="form-control" id="confirmPassword" name="confirmPassword" autocomplete="new-password">
            </div>
            <input type="hidden" th:if="${_csrf != null}" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
            <button type="submit" class="btn btn-primary">Сохранить</button>
        </form>

        <form th:action="@{/logout}" method="post">
            <input type="hidden" th:if="${_csrf != null}" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
            <button type="submit" class="btn btn-primary mt-3">Выйти</button>
        </form>
    </div>
</section>

<footer th:replace="~{fragments/layout :: footer}"></footer>
<th:block th:fragment="modals">
    <div class="modal fade" id="about" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Лабораторная работа по криптографии</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Закрыть"></button>
                </div>
                <div class="modal-body">
                    <p>Группа: ПИбд-43</p>
                    <p>ФИО: Катышева Наталья Евгеньевна</p>
                    <p>Вариант: 12</p>
                    <p>Ограничения: Чередование цифр, знаков арифметических операций и снова цифр</p>
                    <p>Режим шифрования DES: OFB</p>
                    <p>Добавление к ключу случайного значения: нет</p>
                    <p>Алгоритм хеширования пароля: SHA</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Закрыть</button>
                </div>
            </div>
        </div>
    </div>
</th:block>
<th:block th:with="
            successMessage=${message},
            errorMessage=${error},
            modalMessage=${successMessage != null ? successMessage : errorMessage},
            modalClass=${successMessage != null ? 'alert-success' : (errorMessage != null ? 'alert-danger' : '')},
            show=${modalMessage != null}">
    <th:block th:replace="~{fragments/layout :: authNotifModal(
            show=${show},
            message=${modalMessage},
            reload=${false},
            modalClass=${modalClass}
    )}"></th:block>
</th:block>
<th:block th:replace="~{fragments/layout :: scripts}"></th:block>
</body>
</html>
